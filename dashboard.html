<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinDash Pro - Master Build</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="auth.js"></script>
    <link rel="stylesheet" href="dashboard.css">

           
</head>

<body>
<nav class="sidebar" id="sidebar">
        <div class="logo">
            <div class="logo-box"></div>Expense <span>Tracker</span>
        </div>
        <ul class="nav-menu">
            <li><a href="index.html" class="nav-item">ğŸ  Home</a></li>
            <li><a href="dashboard.html" class="nav-item active">ğŸ“Š Dashboard</a></li>
            <li><a href="transactions.html" class="nav-item">ğŸ“œ Transactions</a></li>
            <li id="admin-link" style="display: none;"><a href="#" class="nav-item" onclick="showAdminPanel()">ğŸ‘‘ Admin Panel</a></li>
            <li><a href="#" class="nav-item" onclick="logout()" style="margin-top: 20px; color: #d44d4d;">ğŸšª Logout</a></li>
        </ul>
    </nav>

    <div id="main-dashboard">
        <main class="main-content">
            <header class="top-bar">
                <div class="header-title-area">
                    <button class="menu-toggle" onclick="toggleSidebar()">â˜°</button>
                    <h2 id="viewTitle">Global Overview</h2>
                    <button id="resetBtn" class="btn-reset" onclick="resetFilter()">â†º Back to Global</button>
                </div>
                <div class="btn-group">
                    <button class="action-btn btn-success" onclick="openModal('income')">+ Income</button>
                    <button class="action-btn btn-primary" onclick="openModal('expense')">+ Expense</button>
                </div>
            </header>

            <section class="stats-grid">
                <div class="card">
                    <span id="balLabel">Total Balance</span>
                    <div class="amount" id="totalBalance">$0.00</div>
                </div>
                <div class="card">
                    <span id="spendLabel">Total Spend</span>
                    <span class="active-tag" id="activeMonthTag">GLOBAL</span>
                    <div class="amount" id="totalExpenses">$0.00</div>
                </div>
                <div class="card">
                    <span>Savings Rate</span>
                    <div class="amount" id="savingsPct">0%</div>
                </div>
            </section>

            <section class="charts-section">
                <div class="card">
                    <h3 id="radarTitle">Spending Profile (%)</h3>
                    <div class="radar-container"><canvas id="expenseRadarChart"></canvas></div>
                </div>
                <div class="card">
                    <h3>Trend <small style="color:#8b8c95; font-size: 11px;">(Click month to filter)</small></h3>
                    <div class="chart-wrapper"><canvas id="trendLineChart"></canvas></div>
                </div>
            </section>
        </main>
    </div>

    <div id="admin-panel" style="display: none;">
        <header class="top-bar" style="padding: 20px 40px 0 40px;">
            <div class="header-title-area">
                <button class="menu-toggle" onclick="toggleSidebar()">â˜°</button>
                <h2>Admin Panel - User Management</h2>
                <button class="btn-reset" style="display: inline-block;" onclick="hideAdminPanel()">â† Back to Dashboard</button>
            </div>
        </header>

        <div style="padding: 20px 40px;">
            <div class="card" style="margin-bottom: 30px;">
                <h3 style="margin-bottom: 15px; color: var(--primary);">ğŸ‘‘ Admin Controls</h3>
                <p style="color: #8b8c95; margin-bottom: 20px;">
                    As the system administrator (first user), you can manage all user accounts and their data.
                </p>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                    <div class="stat-item">
                        <div class="stat-number" style="color: var(--primary);" id="total-users-count">0</div>
                        <div style="color: #8b8c95;">Total Users</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number" style="color: var(--success);" id="manageable-users-count">0</div>
                        <div style="color: #8b8c95;">Manageable Users</div>
                    </div>
                </div>
                <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #2a2b33;">
                        <button class="btn-reset" onclick="clearAllUsersExceptAdmin()" style="background: #d44d4d; color: #ffffff; border: none; display: inline-block;">
                        ğŸ—‘ï¸ Clear All Users (Keep Admin Only)
                    </button>
                </div>
            </div>

            <div class="card">
                <h3 style="margin-bottom: 20px; color: var(--primary);">ğŸ‘¥ User Accounts</h3>
                <div id="user-list" class="user-list">
                    </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="transactionModal">
        <div class="modal-content">
            <h3 id="modalTitle">Entry</h3>
            <form id="transactionForm">
                <label class="form-label">Date</label>
                <input type="date" class="form-control" id="tDate" required>
                <label class="form-label">Amount</label>
                <input type="number" step="0.01" class="form-control" id="tAmount" required>
                <label class="form-label">Category</label>
                <select class="form-control" id="tCategory"></select>

                <div id="freqContainer" class="hidden">
                    <label class="form-label">Frequency (Salary Only)</label>
                    <select class="form-control" id="tFreq">
                        <option value="One-time">One-time</option>
                        <option value="Weekly">Weekly</option>
                        <option value="Monthly">Monthly</option>
                        <option value="Yearly">Yearly</option>
                    </select>
                </div>

                <div style="display:flex; justify-content: flex-end; gap:10px; margin-top: 20px;">
                    <button type="button" class="action-btn" style="background:#444"
                        onclick="closeModal()">Cancel</button>
                    <button type="submit" class="action-btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <script src="dashboard.js"></script>
</body>

</html>